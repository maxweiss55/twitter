---
title: "twitter"
author: "Max Weiss"
date: "10/31/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(dplyr)
library(tidyverse)
library(stringr)
library(lubridate)
library(knitr)

```

















```{r}

trump <- read_csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/twitter-ratio/realDonaldTrump.csv")

obama <- read_csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/twitter-ratio/BarackObama.csv")

sens <- read_csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/twitter-ratio/senators.csv")

obama <- obama %>%
  mutate(bioguide_id = NA, party = NA, state = NA)

trump <- trump %>%
  mutate(bioguide_id = NA, party = NA, state = NA)

all_tweets <- rbind(trump, obama, sens)

twitter <- read_csv("twitter/all_tweets.csv")

twitter

write.csv(all_tweets, file = "all_tweets.csv") 

trump

twitter2 <- twitter %>%
  select(created_at, user, retweets) %>%
  mutate(created_at = mdy_hm(created_at)) %>%
  filter(!is.na(created_at), !is.na(user), user %in% c("realDonaldTrump", "BarackObama"))

twitter$created_at

senators_mark <- twitter %>%
  select(-text, -url) %>%
  mutate(created_at = mdy_hm(created_at)) %>%
  filter(!is.na(created_at), !is.na(user), user != "realDonaldTrump", user != "BarackObama")   

senators_kable <- senators_mark %>%
  mutate(Party = case_when(party == "D" ~ "Democrat", party == "R" ~ "Republican", party == "I" ~ "Independent")) %>%
  group_by(Party) %>%
  summarize("Total Senators" = n_distinct(user),
            "Total Tweets" = n(),
            "Average Replies" = round(mean(replies)),
            "Average Retweets" = round(mean(retweets)),
            "Average Favorites" = round(mean(favorites))) %>%
  kable()


senators_kable

senators_mark

```
